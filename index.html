<!DOCTYPE html>
<html lang="en">
  <head>
   <link href="css/bootstrap-responsive.css" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/jquery-ui-1.8.21.custom.css" rel="stylesheet">
    <style>
	    #sortable { list-style-type: none; margin: 0; padding: 0;; }
		#sortable li { margin: 0 5px 5px 5px; padding: 5px; font-size: 1.2em; height: 1.5em; }
		html>body #sortable li { height: 1.5em; line-height: 1.2em; }
		.ui-state-highlight { height: 1.5em; line-height: 1.2em; }
      body {
        margin: 0px;
        padding: 0px;
      }
      canvas {
        border: 0px solid #9C9898;
        margin:5px;
      }
      #container {
        display: inline-block;
        overflow: scroll;
      }
      .alert {
		  margin-bottom: 5px;
		  }
	  .navbar{
		  margin-bottom: 5px;
	  }
	  /*
		Navbar forms
		Adding a Drop Down Login Form to Bootstrap’s Navbar
		http://mifsud.me/adding-dropdown-login-form-bootstraps-navbar/
		*/
		
		div.dropdown-menu {
		    padding: 15px;
		    padding-bottom: 0px;
		}
		
		div.dropdown-menu input.text {
		    margin-bottom: 15px;
		}
		
		div.dropdown-menu input.remember {
		    float: left;
		    margin-right: 10px;
		}
		
		div.dropdown-menu input.btn {
		    clear: left;
		    width: 100%;
		    height: 32px;
		    font-size: 13px;
		}
	​	
    </style>
  
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.js"></script>
    <script type="text/javascript" src="js/lib/kinetic-v3.10.2.js"></script>
    <script src="js/lib/kinetic.line.js"></script>
	<script src="js/lib/kinetic.bezier.js"></script>
	<script type="text/javascript" src="js/kinetic.workflowLayer.js"></script>
    <script type="text/javascript" src="js/kinetic.workFlowElement.js"></script>
    <script type="text/javascript" src="js/kinetic.workFlowComponents.js"></script>
    <script type="text/javascript" src="js/kinetic.workFlow.js"></script>
    <script type="text/javascript" src="js/workflow.ui.js"></script>
    <script type="text/javascript" src="js/workflow.js"></script>
	
	
	<script src="js/lib/underscore.js"></script>
	<script src="js/lib/bootstrap.js"></script>
	<script src="js/lib/spin.min.js"></script>
    
    
    <script type="text/javascript">

    	var layer;
    	window.onload = function() {
    		$(function() {
    			$('a[rel="popover"]').popover();
			});
			$(function() {
    			$('a[rel="tooltip"]').tooltip();
			});
			// Adding a Drop Down Login Form to Bootstrap’s Navbar
			// 
			$(function() {
			    // Setup drop down menu
			    $('.dropdown-toggle').dropdown();
			    
			    // Fix input element click problem
			    $('.dropdown input, .dropdown label').click(function(e) {
			        e.stopPropagation();
			    });
			});
			
			
	    	var stage = new Kinetic.Stage({
	          container: "container",
	          width: $(document).width()-10,
	          height:$(document).height() - 60
	        });
	        
	        
	        
	    	layer = new Kinetic.WorkFlowLayer();
	        stage.add(layer);
	        ctx = stage.children[0].getContext();
	        ctx.font = fontSize + "Calibri";
	       
	        start = new Kinetic.WorkFlowStart({x:20,y:20,text:"Start",draggable:true});
	        layer.addElement(start);
	        	        
	        stage.draw();
	        //layer.reDrawLayer();
	        layer.updateAllVertices();
	        //layer.convertToBPMN();
	        
	        document.getElementById('moveup').addEventListener('click', function() {
          		layer.moveUp();
        	}, false);
        	document.getElementById('addWF').addEventListener('click', function() {
          		WorkFlow_UI.addWF.open();
        	}, false);
        	document.getElementById('io').addEventListener('click', function() {
          		
          		if(layer.toggleIOMode())
          		{
          			$("#io").html('Toggle Input/Output Mode - On');
          		}
          		else
          		{
          			$("#io").html('Toggle Input/Output Mode - Off');
          		}
          	}, false);
          	document.getElementById('redraw').addEventListener('click', function() {
          		layer.reDrawLayer();
	        },false);
	        document.getElementById('setOrder').addEventListener('click', function() {
          		WorkFlow_UI.orderComponents.open();
	        },false);
	        
	        

          	var con = $('#container');
          	con.droppable({
		              drop: function(el,ui) {
                        	WorkFlow_UI.search.doDrop(el,ui,layer)
                    }
		               				               		
		    });
		    $('#ioModal').on('hidden', function () {
			    layer.clearIOMode();
			})
          	
       
	
        };
    </script>
   </head>
  <body>
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
        <ul class="nav">
        <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                    
                    <b class="caret"></b>
                </a>
                <div class="dropdown-menu">
                    
                        <input class="text" type="text" id="search" name="search"
                            size="50" onchange="WorkFlow_UI.search.doSearch()" placeholder="Type Keywords" />
                    
                    <div class="well" id="searchResults">
                    </div>
                </div>
            </li>
        </ul>
        <a class="brand" href="">Uncert Web</a>
        <div class="nav-collapse">
          <ul class="nav">
           
           <li><a id="addWF">Add WorkFlow</a></li>
          	<li><a id="moveup">Move Up</a></li>
            <li><a id="io">Toggle Input/Output Mode - Off</a></li>
            <li><a id="redraw">Auto Layout</a></li>
            <li><a id="setOrder">Set Ordeccr</a></li>
          </ul>
        </div><!-- /.nav-collapse -->
      </div>
    </div><!-- /navbar-inner -->
  </div>
    <div id="container" class="droppable"></div>
        
    
    <div id="ioModal" class="modal hide fade" style="display: none; ">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">×</button>
              <h3>Input/Output</h3>
            </div>
            <div class="modal-body">
	            
	       
	         <div class="accordion" id="ioAccordion">
                       <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" id="outputHeading" data-toggle="collapse" data-parent="#ioAccordion" href="#outputCollapse">
                  Output Description
                </a>
              </div>
              <div id="outputCollapse" class="accordion-body collapse in">
                <div class="accordion-inner" id="outputDesc">
	                Test
                </div>
              </div>
            </div>
             <div class="accordion-group">
              <div class="accordion-heading" >
                <a class="accordion-toggle" id="inputHeading" data-toggle="collapse" data-parent="#ioAccordion" href="#inputCollapse">
                  Input Description
                </a>
              </div>
              <div id="inputCollapse" class="accordion-body collapse in" style="height: 0px; ">
                <div class="accordion-inner" id="inputDesc">
                 test
                </div>
              </div>
            </div>

          </div>
				
				<div class="span10" id="dropdowns">
					<div class="row">
						<div class="span4"><h3>Inputs</h3></div>
						<div class="span4"><h3>Outputs</h3></div>
						<div class="span1"></div>
					</div>
				</div>
            </div>
            <div class="modal-footer">
              <a class="btn" data-dismiss="modal">Done</a>
              <!--<button href="#" class="btn btn-primary" onclick="WorkFlow_UI.io.test()">Save changes</button>-->
            </div>
     </div>
     <div id="ioWorkFlowModal" class="modal hide fade" style="display: none; ">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">×</button>
              <h3 id="ioWorkFlowHeader"></h3>
            </div>
            <div class="modal-body">
				<div class="span6" id="ioDropdownWF">
					
				</div>
            </div>
            <div class="modal-footer">
              <a class="btn" data-dismiss="modal">Done</a>
              <!--<button href="#" class="btn btn-primary" onclick="WorkFlow_UI.io.test()">Save changes</button>-->
            </div>
     </div>
     <div id="newWFModal" class="modal hide" style="display: none; ">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">×</button>
              <h3>New WorkFlow</h3>
            </div>
            <div class="modal-body">
            	<form class="form-horizontal well" onsubmit="WorkFlow_UI.addWF.add();return false">
				  <fieldset>
				    <legend>New Workflow</legend>
				    <div class="control-group" id="titleGroup">
				      <label class="control-label" for="titleWF">Title</label>
				      <div class="controls">
				        <input type="text" class="input-xlarge" id="titleWF" placeholder="Enter Title....">
				        
				      </div>
				    </div>
				    <div class="control-group" id="abstractGroup">
				      <label class="control-label" for="abstractWF">Abstract</label>
				      <div class="controls">
				        <textarea class="input-xlarge" id="abstractWF" rows="3" placeholder="Enter a description for your workflow...."></textarea>
				      </div>
				    </div>
				    <div class="form-actions">
			            <button type="submit" class="btn btn-primary">Create Workflow</button>
			            <button class="btn">Cancel</button>
		            </div>
				  </fieldset>
				</form>
            </div>
            <div class="modal-footer">
              <a class="btn" data-dismiss="modal">Done</a>
              <!--<button href="#" class="btn btn-primary" onclick="WorkFlow_UI.io.test()">Save changes</button>-->
            </div>
     </div>
     <div id="orderComponents" class="modal hide" style="display: none; ">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">×</button>
              <h3>Order Components</h3>
            </div>
            <div class="modal-body" id="orderComponents">
	            <ul id="sortable">
					
				</ul>
            </div>
            <div class="modal-footer">
              <a class="btn" data-dismiss="modal">Done</a>
              <!--<button href="#" class="btn btn-primary" onclick="WorkFlow_UI.io.test()">Save changes</button>-->
            </div>
     </div>

     
  </body>
</html>